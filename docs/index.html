---

title: nbdev_all_demo


keywords: fastai
sidebar: home_sidebar

summary: "Demoing the issue at https://github.com/fastai/nbdev/issues/328"
description: "Demoing the issue at https://github.com/fastai/nbdev/issues/328"
nb_path: "index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary-of-the-issue">Summary of the issue<a class="anchor-link" href="#Summary-of-the-issue"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I've created two nearly identical notebooks: <code>m1</code> and <code>m1_copy</code>, which both import the math module as <code>math1</code> and <code>math2</code> respectively, and 'exports' them by default (via _all_).</p>
<p>The only catch is:</p>
<ul>
<li>First I ran nbdev_build_lib for both, which generated <code>m1.py</code> and <code>m1_copy.py</code> respectively</li>
<li>In <code>m1_copy.py</code>, I added an extra print statement and then ran <code>nbdev_upload_lib</code></li>
</ul>
<p>This added the print statement in <code>m1_copy.ipynb</code>, but it also incorrectly replaced the <code>_all_ = ['math2']</code> line with <code>#nbdev_comment _all_ = ['math2']</code>. This is likely happening because when <code>nbdev_upload_lib</code> parses <code>m1_copy.py</code>, it doesn't treat <code>#nbdev_comment</code> comments specially.</p>
<p>So, on running <code>nbdev_build_lib</code> again (say, I changed some random notebook), the <code>__all__</code> variable in <code>m1_copy.py</code> becomes <code>[]</code>, as there is no (uncommented) <code>_all_ = ['math2']</code> statement in the notebook.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So now, when I try to use <code>math2</code> after importing <code>m1_copy</code>, it gives an error</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nbdev_all_demo.m1_copy</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>m1_copy loaded, pi= 3.141592653589793
This is added directly in m1_copy.py
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">math2</span><span class="o">.</span><span class="n">pi</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">&lt;ipython-input-4-e78faf57ed6d&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">----&gt; 1</span><span class="ansi-yellow-intense-fg ansi-bold"> </span>math2<span class="ansi-yellow-intense-fg ansi-bold">.</span>pi

<span class="ansi-red-intense-fg ansi-bold">NameError</span>: name &#39;math2&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

